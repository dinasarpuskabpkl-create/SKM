<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Survei Arpus Pekalongan</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <style>
        /* Sembunyikan laporan di layar HP */
@media (max-width: 768px) {
    #section-laporan {
        display: none !important;
    }
}

/* Munculkan kembali hanya di layar Laptop/Desktop */
@media (min-width: 769px) {
    #section-laporan {
        display: block;
    }
}
        .swiper {
    width: 100%;
    padding-bottom: 40px !important;
}

.swiper-slide {
    display: flex;
    justify-content: center;
    align-items: center;
    height: auto; /* Agar tinggi kartu sama */
}
        :root { --biru: #003d7a; --langit: #007bff; --hijau: #28a745; --abu: #f8f9fa; --text: #333; }
        
        body { font-family: 'Segoe UI', sans-serif; background: #cbdcf7; margin: 0; min-height: 100vh; padding: 20px; display: flex; justify-content: center; color: var(--text); }

        .container { background: white; width: 95%; max-width: 1400px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); overflow: hidden; position: relative; }
        
        /* HEADER - DINAS ARPUS BESAR */
        .header { background: linear-gradient(135deg, var(--biru), var(--langit)); padding: 20px 40px; display: flex; align-items: center; color: white; gap: 20px; }
        .header img { width: 50px; height: auto; } /* Ukuran Logo Header */
        .header .title-area { display: flex; flex-direction: column; }
        .header h1 { margin: 0; font-size: 32px; line-height: 1; text-transform: uppercase; }
        .header h2 { margin: 5px 0 0 0; font-size: 16px; font-weight: 300; }

        .step { display: none; padding: 50px; }
        .active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* WELCOME SPLIT - Ukuran Gambar Diatur Di Sini */
        .welcome-split { display: flex; align-items: center; gap: 50px; }
        .welcome-img { flex: 1; text-align: center; }
        .welcome-img img { width: 70%; max-width: 400px; border-radius: 15px; } /* Ukuran gambar orang membaca */
        .welcome-text { flex: 1; }

        /* FORM BIODATA */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px 50px; max-width: 1100px; margin: 0 auto; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--biru); }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 15px; box-sizing: border-box; }

        /* KUESIONER */
        .q-box { display: none; text-align: center; max-width: 850px; margin: 0 auto; }
        .q-box.q-active { display: block; }
        .emoji-grid { display: flex; justify-content: space-around; gap: 20px; margin: 40px 0; }
        .emoji-item { flex: 1; padding: 25px; border: 2px solid #eee; border-radius: 20px; cursor: pointer; transition: 0.3s; background: #fff; }
        .emoji-item span { font-size: 50px; display: block; }
        .emoji-item.selected { border-color: var(--hijau); background: #f0fff4; transform: scale(1.05); }

        /* TOMBOL */
        .btn-group { display: flex; justify-content: center; gap: 15px; margin-top: 40px; }
        .btn { background: var(--langit); color: white; border: none; padding: 18px 45px; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .btn:hover { background: var(--biru); transform: translateY(-2px); }
        .btn-back { background: #e2e8f0; color: #4a5568; }

        /* LOGO TAMBAHAN DI BAWAH TOMBOL */
        .extra-logos { margin-top: 40px; display: flex; gap: 40px; align-items: center; }
        .extra-logos img { height: 80px; width: auto; opacity: 50; }
        .extra-logos img { height: 100px; width: auto; opacity: 100; }


        /* MODAL & SUCCESS */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 40px; border-radius: 15px; text-align: center; max-width: 450px; width: 90%; }
        .success-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; flex-direction: column; justify-content: center; align-items: center; }
        .checkmark-circle { width: 120px; height: 120px; border-radius: 50%; background: var(--hijau); display: flex; justify-content: center; align-items: center; margin-bottom: 20px; animation: scaleUp 0.5s ease; }
        .checkmark-icon { color: white; font-size: 70px; font-weight: bold; }
        @keyframes scaleUp { from { transform: scale(0); } to { transform: scale(1); } }

        /* REKAP & ADMIN TABLE */
        .card-indeks { background: var(--hijau); color: white; padding: 30px; border-radius: 20px; max-width: 400px; margin: 20px auto; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .card-indeks div { font-size: 55px; font-weight: 800; }
        .table-container { overflow-x: auto; margin-top: 30px; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 1200px; background: white; }
        th { background: var(--biru); color: white; padding: 15px; font-size: 13px; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-size: 13px; }
        /* ===============================
   RESPONSIVE FINAL (HP)
   =============================== */
@media (max-width: 768px) {

    .header {
        flex-direction: column;
        text-align: center;
        padding: 16px;
    }

    .header img {
        width: 42px;
        margin-bottom: 5px;
    }

    .header h1 {
        font-size: 20px;
    }

    .header h2 {
        font-size: 13px;
    }

    .step {
        padding: 20px;
    }

    .welcome-split {
        flex-direction: column;
        text-align: center;
        gap: 25px;
    }

    .welcome-img img {
        width: 85%;
        max-width: 260px;
    }

    .welcome-text h2 {
        font-size: 28px !important;
    }

    .welcome-text p {
        font-size: 15px !important;
    }

    .btn-group {
        flex-direction: column;
        gap: 12px;
    }

    .btn {
        width: 100%;
        padding: 14px;
        font-size: 15px;
    }

    .form-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }

    .emoji-grid {
        flex-wrap: wrap;
        gap: 15px;
    }

    .emoji-item {
        flex: 0 0 48%;
        padding: 18px;
    }

    .emoji-item span {
        font-size: 36px;
    }

    .extra-logos {
        justify-content: center;
        flex-wrap: wrap;
        gap: 20px;
    }

    .extra-logos img {
        height: 60px;
    }

    .table-container {
        overflow-x: auto;
    }
}

    
     /* Agar Kecamatan & Jenis Layanan jadi atas-bawah di HP */
    .form-grid {
        grid-template-columns: 1fr !important; 
        gap: 10px !important;
    }

    /* Agar emoji tidak terlalu besar di layar kecil */
    .emoji-item span {
        font-size: 2rem !important;
    }
/* Container Swiper */
/* 1. Merampingkan Container & Kartu */
.swiper {
    max-width: 1100px; /* Membatasi lebar agar tidak melebar se-layar penuh */
    margin: 0 auto;    /* Mengetengahkan slider */
    padding: 20px 60px; /* Memberi ruang untuk panah di pinggir */
}

.skm-card-new {
    background: white;
    border-radius: 15px;
    padding: 25px 15px;
    text-align: center;
    max-width: 280px; /* KUNCI: Membuat kartu lebih ramping */
    margin: 0 auto;
    box-shadow: 0 10px 20px rgba(0,0,0,0.05);
    border: 1px solid #f0f0f0;
}

/* 2. Mengecilkan Tombol Panah Geser */
.swiper-button-next, 
.swiper-button-prev {
    width: 50px !important;  /* Ukuran lingkaran panah */
    height: 35px !important;
    background: white;       /* Memberi background putih agar bersih */
    border-radius: 50%;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    color: var(--biru) !important;
}

/* Mengecilkan icon panahnya saja */
.swiper-button-next:after, 
.swiper-button-prev:after {
    font-size: 18px !important; /* Ukuran icon panah lebih kecil */
    font-weight: bold;
}

/* Mengatur posisi panah agar tidak terlalu jauh ke luar */
.swiper-button-prev { left: 10px !important; }
.swiper-button-next { right: 10px !important; }

/* Ukuran Judul Laporan agar tidak terlalu besar */
.skm-card-new h3 {
    font-size: 1.1rem;
    margin: 15px 0 10px;
    color: #333;
}

/* Tombol Biru Khas Layanan Publik */
.btn-pdf-lihat {
    display: inline-block;
    text-decoration: none;
    color: #007bff;
    font-weight: 700;
    border: 2px solid #007bff;
    padding: 10px 25px;
    border-radius: 30px;
    font-size: 14px;
    transition: 0.3s;
    margin-top: 10px;
}

.btn-pdf-lihat:hover {
    background: #007bff;
    color: white;
}

/* Warna titik pagination */
.swiper-pagination-bullet-active {
    background: #007bff !important;
    width: 25px !important;
    border-radius: 5px !important;
}

.btn-pdf-lihat {
    display: inline-block;
    text-decoration: none;
    color: var(--langit);
    font-weight: bold;
    border: 1.5px solid var(--langit);
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 13px;
    transition: 0.3s;
}
.btn-pdf-lihat:hover {
    background: var(--langit);
    color: white;
}
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="dinas.png" alt="Logo"> <div class="title-area">
            <h1>DINAS ARPUS</h1>
            <h2>Kabupaten Pekalongan</h2>
        </div>
    </div>
<div id="p1" class="step active">
    <div class="welcome-split">
        <div class="welcome-img">
            <img src="gambar.png" alt="Library Illustration">
        </div>
        <div class="welcome-text">
            <h2 style="font-size: 42px; color: var(--biru); margin-bottom: 15px;">Survei Kepuasan Masyarakat</h2>
            <p style="font-size: 19px; color: #666; margin-bottom: 35px;">Wujudkan pelayanan publik yang lebih baik bersama Dinas Kearsipan dan Perpustakaan Kabupaten Pekalongan.</p>
            <div class="btn-group" style="justify-content: flex-start;">
                <button class="btn" onclick="go(2)">MULAI SURVEI</button>
                <button class="btn btn-back" onclick="goRekap()">CEK LAPORAN</button>
            </div>
            <div class="extra-logos">
                <img src="bangga.png" alt="Logo 1">  <img src="berakhlaq.png" alt="Logo 2"> 
            </div>
        </div>
    </div>

<div id="section-laporan" style="margin-top: 80px; border-top: 2px solid #eee; padding-top: 40px; width: 100%;">
    <h2 style="text-align:center; color: var(--biru); font-weight: 800; text-transform: uppercase; margin-bottom: 30px;font-size: 35px;">
        LAPORAN SURVEY KEPUASAN MASYARAKAT
    </h2>

    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide"></div>
            
            <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2018</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2018</p>
                    <a href="https://drive.google.com/file/d/1DcBeUgZFVUlDktsgkEthfhKNEYYOHpIo/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
             <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2019</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2019</p>
                    <a href="https://drive.google.com/file/d/1EB5QSL_z-7LnByrJSHzC6ZrSfcG0U7cl/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="skm-card-new">
                 <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2020</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2020</p>
                    <a href="https://drive.google.com/file/d/1orGrL5DoD95U-GKkGH0fyYBSRTmhiuQo/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
             <div class="swiper-slide">
                <div class="skm-card-new">
                 <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2021</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2021</p>
                    <a href="https://drive.google.com/file/d/1iacGphsFtFHfK-j1BM9i2Rw2JMeZd4xd/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2022</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2022</p>
                    <a href="https://drive.google.com/file/d/111uSekZNfCz3M6AhoarU9kqRSJXZb3G3/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2023</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2023</p>
                    <a href="https://drive.google.com/file/d/1VOuVLAj4UoVE5sdkE6MVyZsnccSlcheu/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
             <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2024</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2024</p>
                    <a href="https://drive.google.com/file/d/19x7DGrcDcFn34jn-A50KnD7avNHMtusG/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>
             <div class="swiper-slide">
                <div class="skm-card-new">
                    <img src="dinas.png" style="width: 60px; margin-bottom: 15px;">
                    <h3>SKM Tahun 2025</h3>
                    <p>Laporan SKM Dinas Kearsipan dan Perpustakaan Tahun 2025</p>
                    <a href="https://drive.google.com/file/d/1rTebrhEmeMky2N5YqViFUxXC_ZVnMKDI/view" target="_blank" class="btn-pdf-lihat">Lihat Laporan ‚Üí</a>
                </div>
            </div>


        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
</div>
        <div class="swiper-pagination" style="bottom: 0;"></div>
    </div>

    
    <div id="p2" class="step">
        <h2 style="text-align: center; margin-bottom: 30px;">BIODATA RESPONDEN</h2>
        <div class="form-grid">
            <div class="form-group"><label>Nama Lengkap</label><input type="text" id="nama"></div>
            <div class="form-group"><label>Jenis Kelamin</label><select id="jk"><option value="">-- Pilih --</option><option value="L">Laki-laki</option><option value="P">Perempuan</option></select></div>
           <div class="form-group">
    <label>Umur</label>
    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
        <label style="font-weight: normal;"><input type="radio" name="usia_pilihan" value="< 20"> < 20</label>
        <label style="font-weight: normal;"><input type="radio" name="usia_pilihan" value="20 - 29"> 20 - 29</label>
        <label style="font-weight: normal;"><input type="radio" name="usia_pilihan" value="30 - 39"> 30 - 39</label>
        <label style="font-weight: normal;"><input type="radio" name="usia_pilihan" value="40 - 49"> 40 - 49</label>
        <label style="font-weight: normal;"><input type="radio" name="usia_pilihan" value=">= 50"> >= 50</label>
    </div>
    <input type="hidden" id="usia">
</div>
            <div class="form-group"><label>Nomor HP</label><input type="number" id="WA" placeholder="08xxxxxxxxxx" required></div>
            
            <div class="form-group"><label>Pendidikan</label><select id="pendidikan"><option value="">-- Pilih --</option><option value="SD/Sederajat">SD/Sederajat</option><option value="SMP">SMP/Sederajat</option><option value="SMA/SMK/Sederajat">SMA/SMK/Sederajat</option>
                <option value="Diploma">Diploma</option><option value="S1">S1</option><option value="S2/S3">S2/S3</option></select></div>
            <div class="form-group"><label>Pekerjaan</label><select id="pekerjaan"><option value="">-- Pilih --</option>
                  <option value="PNS/PPPK">PNS/PPPK</option> 
               <option value="TNI/POLRI">TNI/POLRI</option>
               <option value="Karyawan Swasta">Karyawan Swasta</option>
                <option value="Karyawan Honorer">Karyawan Honorer</option>
               <option value="Karyawan BUMD/BUMN">Karyawan BUMD/BUMN</option>
               <option value="Dosen">Dosen</option>
               <option value="Wiraswasta">Wiraswasta</option>
                <option value="Pelajar/Mahasiswa">Pelajar/Mahasiswa</option>
                <option value="Pedagang">Pedagang</option> 
                <option value="Ibu Rumah Tangga">Ibu Rumah Tangga</option>
                <option value="Nelayan">Nelayan</option> 
                <option value="Seniman">Seniman</option> 
                <option value="Bidan">Bidan</option> 
                <option value="Dokter">Dokter</option> 
                <option value="Apoteker">Apoteker</option>
                <option value="Perawat">Perawat</option> 
                <option value="Ustadz/Ustadzah">Ustadz/Ustadzah</option> 
                <option value="Pengusaha">Pengusaha</option> 
                <option value="Pensiunan">Pensiunan</option> 
                 <option value="konten creator">konten creator</option> 
                <option value="Belum/Tidak Bekerja">Belum/Tidak Bekerja</option> 
                <option value="Lainnya">Lainnya</option></select></div>
            <div class="form-group"><label>Kecamatan</label>
                <select id="kec">
                    <option value="">-- Pilih --</option>
                    <option value="Kajen">Kajen</option><option value="Kesesi">Kesesi</option><option value="Sragi">Sragi</option><option value="Bojong">Bojong</option><option value="Wonopringgo">Wonopringgo</option><option value="Kedungwuni">Kedungwuni</option><option value="Buaran">Buaran</option><option value="Tirto">Tirto</option><option value="Wiradesa">Wiradesa</option><option value="Siwalan">Siwalan</option><option value="Wonokerto">Wonokerto</option><option value="Karangdadap">Karangdadap</option><option value="Talun">Talun</option><option value="Doro">Doro</option><option value="Karanganyar">Karanganyar</option><option value="Lebakbarang">Lebakbarang</option><option value="Paninggaran">Paninggaran</option><option value="Kandangserang">Kandangserang</option><option value="Petungkriyono">Petungkriyono</option>
                </select>
            </div>
            <div class="form-group"><label>Jenis Layanan</label>
                <select id="layanan">
                    <option value="">-- Pilih Layanan --</option>
                    <option value="Informasi Arsip">Layanan Informasi Arsip</option>
                    <option value="Peminjaman Arsip">Layanan Peminjaman Arsip</option>
                    <option value="Konsultasi Kearsipan">Layanan Konsultasi Kearsipan</option>
                    <option value="Fasilitas Kearsipan">Layanan Fasilitas Kearsipan</option>
                    <option value="Layanan Pengaduan">Layanan Pengaduan</option>
                     <option value="Layanan Pengaduan">Layanan Umum Perpustakaan</option>
                </select>
            </div>
        </div>
        <div class="btn-group">
            <button class="btn btn-back" onclick="go(1)">KEMBALI</button>
            <button class="btn" onclick="validasiBiodata()">LANJUT KE PENILAIAN</button>
        </div>
    </div>

    <div id="p3" class="step">
        <h2 style="text-align:center;">Survei Kepuasan Masyarakat Tahun <span id="thnKues"></span></h2>
        
        <div id="stepQ1" class="q-box q-active">
            <h3>Bagaimana pendapat saudara tentang kesesuaian persyaratan pelayanan dengan jenis pelayanannya?</h3>
            <div class="emoji-grid" id="q1">
                <div class="emoji-item" onclick="pilih(this, 'q1', 100)"><span>üòç</span><b>Sangat Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q1', 75)"><span>üòä</span><b>Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q1', 50)"><span>üòê</span><b>Kurang Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q1', 25)"><span>‚òπÔ∏è</span><b>Tidak Sesuai</b></div>
            </div>
            <button class="btn" onclick="nextQ(2)">SELANJUTNYA</button>
        </div>

        <div id="stepQ2" class="q-box">
            <h3>Bagaimana pemahaman saudara tentang kemudahan prosedur layanan di unit ini?</h3>
            <div class="emoji-grid" id="q2">
                <div class="emoji-item" onclick="pilih(this, 'q2', 100)"><span>üòç</span><b>Sangat Mudah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q2', 75)"><span>üòä</span><b>Mudah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q2', 50)"><span>üòê</span><b>Kurang Mudah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q2', 25)"><span>‚òπÔ∏è</span><b>Tidak Mudah</b></div>
            </div>
            <button class="btn" onclick="nextQ(3)">SELANJUTNYA</button>
        </div>

        <div id="stepQ3" class="q-box">
            <h3>Bagaimana pendapat saudara tentang Kecepatan Waktu dalam memberikan pelayanan?</h3>
            <div class="emoji-grid" id="q3">
                <div class="emoji-item" onclick="pilih(this, 'q3', 100)"><span>üòç</span><b>Sangat Cepat</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q3', 75)"><span>üòä</span><b>Cepat</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q3', 50)"><span>üòê</span><b>Kurang Cepat</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q3', 25)"><span>‚òπÔ∏è</span><b>Tidak Cepat</b></div>
            </div>
            <button class="btn" onclick="nextQ(4)">SELANJUTNYA</button>
        </div>

        <div id="stepQ4" class="q-box">
            <h3>Bagaimana pendapat saudara tentang kewajaran biaya atau tarif dalam pelayanan</h3>
            <div class="emoji-grid" id="q4">
                <div class="emoji-item" onclick="pilih(this, 'q4', 100)"><span>üòç</span><b>Gratis</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q4', 75)"><span>üòä</span><b>Murah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q4', 50)"><span>üòê</span><b>Cukup Mahal</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q4', 25)"><span>‚òπÔ∏è</span><b>Sangat Mahal</b></div>
            </div>
             <button class="btn" onclick="nextQ(5)">SELANJUTNYA</button>
        </div>

            <div id="stepQ5" class="q-box">
            <h3>Bagaimana pendapat saudara tentang kesesuaian produk pelayanan antara yang tercantum dalam standar pelayanan dengan hasil yang di berikan</h3>
            <div class="emoji-grid" id="q5">
                <div class="emoji-item" onclick="pilih(this, 'q5', 100)"><span>üòç</span><b>Sangat Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q5', 75)"><span>üòä</span><b>Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q5', 50)"><span>üòê</span><b>Kurang Sesuai</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q5', 25)"><span>‚òπÔ∏è</span><b>Tidak Sesuai</b></div>
            </div>
             <button class="btn" onclick="nextQ(6)">SELANJUTNYA</button>
        </div>

            <div id="stepQ6" class="q-box">
            <h3>Bagaimana pendapat saudara tentang kompetensi atau kemampuan petugas dalam pelayanan?</h3>
            <div class="emoji-grid" id="q6">
                <div class="emoji-item" onclick="pilih(this, 'q6', 100)"><span>üòç</span><b>Sangat Kompeten</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q6', 75)"><span>üòä</span><b>Kompeten</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q6', 50)"><span>üòê</span><b>Kurang Kompeten</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q6', 25)"><span>‚òπÔ∏è</span><b>Tidak Kompeten</b></div>
            </div>
             <button class="btn" onclick="nextQ(7)">SELANJUTNYA</button>
        </div>

             <div id="stepQ7" class="q-box">
            <h3>Bagaimana pendapat saudara perilaku petugas dalam pelayanan terkait kesopanan dan keramahan?</h3>
            <div class="emoji-grid" id="q7">
                <div class="emoji-item" onclick="pilih(this, 'q7', 100)"><span>üòç</span><b>Sangat Sopan dan Ramah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q7', 75)"><span>üòä</span><b>Sopan Dan Ramah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q7', 50)"><span>üòê</span><b>Kuang Sopan dan Ramah</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q7', 25)"><span>‚òπÔ∏è</span><b>Tidak Sopan dan Ramah</b></div>
            </div>
             <button class="btn" onclick="nextQ(8)">SELANJUTNYA</button>
        </div>

             <div id="stepQ8" class="q-box">
            <h3>Bagaimana pendapat saudara tentang kualitas sarana dan prasarana?</h3>
            <div class="emoji-grid" id="q8">
                <div class="emoji-item" onclick="pilih(this, 'q8', 100)"><span>üòç</span><b>Sangat Baik</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q8', 75)"><span>üòä</span><b>Baik</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q8', 50)"><span>üòê</span><b>Cukup</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q8', 25)"><span>‚òπÔ∏è</span><b>Buruk</b></div>
            </div>
             <button class="btn" onclick="nextQ(9)">SELANJUTNYA</button>
        </div>

              <div id="stepQ9" class="q-box">
            <h3>Bagaimana pendapat saudara tentang penanganan, pengaduan pengguna layanan?</h3>
            <div class="emoji-grid" id="q9">
                <input type="hidden" name="q9" id="q9_input" value="">
                <div class="emoji-item" onclick="pilih(this, 'q9', 100)"><span>üòç</span><b>Dikelola Dengan Baik</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q9', 75)"><span>üòä</span><b>Berfungsi Kurang Maksimal</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q9', 50)"><span>üòê</span><b>Ada Tetapi Tidak Berfungsi</b></div>
                <div class="emoji-item" onclick="pilih(this, 'q9', 25)"><span>‚òπÔ∏è</span><b>Tidak Ada</b></div>
            </div>
             <button class="btn" onclick="nextQ(10)">SELANJUTNYA</button>
              </div>

            <div id="stepQ10" class="q-box">
    <h3>Saran dan Masukan</h3>
    <p style="max-width:600px;margin:0 auto 20px;">
        Apakah Anda memiliki saran untuk meningkatkan pelayanan kami?
    </p>

    <textarea id="Saran" rows="5"
        style="width:100%;max-width:600px;border-radius:12px;padding:15px;border:1px solid #ccc;"
        placeholder="Tulis saran Anda di sini (opsional)..."></textarea>

    <div class="btn-group" style="margin-top: 20px;">
        <button type="button" class="btn" onclick="konfirmasiSimpan()" style="background: var(--hijau); width: 50%;">SIMPAN JAWABAN</button>
    </div>
</div>
    </div>
<div id="pRekap" class="step">
        <h2 style="text-align:center;">Laporan Indeks Kepuasan</h2>
        <div style="text-align:center; margin-bottom:20px;">
            Filter Tahun: <select id="fTahun" onchange="renderRekap()" style="width:120px;"></select>
        </div>
        <div class="card-indeks" id="kotak-skor">
            <small id="label-laporan">IKM RATA-RATA KESELURUHAN</small>
            <div id="rAvg">Memuat...</div> 
            <div id="predikat-teks" style="font-size: 18px; margin-top: 10px; font-weight: bold;"></div>
        </div>
        <div class="btn-group">
            <button class="btn btn-back" onclick="go(1)">KEMBALI KE BERANDA</button>
        </div>
    </div> <div style="text-align: center; padding: 20px; color: #666; font-size: 14px; border-top: 1px solid #eee; margin-top: 30px;">
        Dinas Kearsipan dan Perpustakaan Kabupaten Pekalongan &copy; <span id="copyYear"></span>
    </div> 

</div> <div id="modalKonfirmasi" class="modal-overlay">
    <div class="modal-content">
        <h2 style="color:var(--biru); margin-top:0;">Konfirmasi</h2>
        <p style="font-size:18px;">Apakah Anda sudah yakin dengan jawabannya?</p>
        <div class="btn-group">
            <button class="btn btn-back" onclick="tutupModal()">BELUM</button>
            <button class="btn" style="background:var(--hijau);" onclick="prosesSimpan()">YA, SUDAH YAKIN</button>
        </div>
    </div>
</div>

<div id="successOverlay" class="success-overlay">
    <div class="checkmark-circle"><div class="checkmark-icon">‚úì</div></div>
    <h1 style="color:var(--hijau); margin:0;">Terima Kasih!</h1>
    <p style="font-size:18px; color:#666;">Data Anda telah berhasil disimpan.</p>
</div>

<script>
    document.getElementById('copyYear').innerText = new Date().getFullYear();
    let skor = { q1: 0, q2: 0, q3: 0, q4: 0, q5: 0, q6: 0, q7: 0, q8: 0, q9: 0 };
    const TAHUN_INI = new Date().getFullYear();
    // PASTIKAN URL INI ADALAH HASIL DEPLOY "ANYONE" TERBARU
    const urlScript = "https://script.google.com/macros/s/AKfycbyCFi1BFcLEQ9w1f7O8osz9FKsQbgrfK-OcQqO-q9OZopOxnoC7tHKXfWJ3wwGuJrTpmA/exec";

    window.onload = function() {
        document.getElementById('thnKues').innerText = TAHUN_INI;
        let st = document.getElementById('fTahun');
        for (let i = TAHUN_INI; i >= TAHUN_INI - 2; i--) {
            let o = document.createElement('option'); o.value = i; o.innerText = i; st.appendChild(o);
        }
       
    }

    function go(s) {
        document.querySelectorAll('.step').forEach(d => d.classList.remove('active'));
        if(s === 'Rekap') document.getElementById('pRekap').classList.add('active');
        else document.getElementById('p' + s).classList.add('active');
        window.scrollTo(0,0);
    }

    function validasiBiodata() {
    // 1. Ambil nilai dari radio button umur yang dipilih responden
    const pilihanUsia = document.querySelector('input[name="usia_pilihan"]:checked');
    
    // 2. Masukkan nilainya ke input hidden 'usia' agar bisa dibaca oleh sistem 'fields' di bawah
    if (pilihanUsia) {
        document.getElementById('usia').value = pilihanUsia.value;
    }

    // 3. Validasi semua kolom termasuk umur
    const fields = ['nama', 'jk', 'WA', 'usia', 'pendidikan', 'pekerjaan', 'kec', 'layanan'];
    for(let f of fields) { 
        if(document.getElementById(f).value === "") {
            return alert("Harap melengkapi seluruh kolom yang tersedia sebelum melanjutkan!"); 
        }
    }
    
    // 4. Jika semua sudah terisi, lanjut ke kuesioner
    go(3);
}
    

    function nextQ(n) {
        if(!skor['q'+(n-1)]) return alert("Pilih salah satu emoji!");
        document.querySelectorAll('.q-box').forEach(q => q.classList.remove('q-active'));
        document.getElementById('stepQ' + n).classList.add('q-active');
    }

    function pilih(el, g, v) {
        skor[g] = v;
        document.querySelectorAll('#' + g + ' .emoji-item').forEach(i => i.classList.remove('selected'));
        el.classList.add('selected');
    }

    function konfirmasiSimpan() {
        if(!skor.q9) return alert("Pilih penilaian terakhir!"); // Perbaikan Q9
        document.getElementById('modalKonfirmasi').style.display = 'flex';
    }

    function tutupModal() { document.getElementById('modalKonfirmasi').style.display = 'none'; }

    function prosesSimpan() {
    tutupModal();
    document.getElementById('successOverlay').style.display = 'flex'; // Menampilkan ucapan di web
    
    let namaUser = document.getElementById('nama').value;

    let dataBaru = {
        id: Date.now(),
        n: namaUser,
        j: document.getElementById('jk').value,
        w: document.getElementById('WA').value,
        p: document.getElementById('pekerjaan').value,
        k: document.getElementById('kec').value,
        l: document.getElementById('layanan').value,
        y: TAHUN_INI,
        s1: skor.q1, s2: skor.q2, s3: skor.q3, s4: skor.q4, 
        s5: skor.q5, s6: skor.q6, s7: skor.q7, s8: skor.q8, s9: skor.q9,
        saran: document.getElementById('Saran').value 
    };

    // Proses kirim ke Google Sheets & Trigger Email Otomatis
    fetch(urlScript, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify(dataBaru)
    })
    .then(() => {
        console.log("Data berhasil dikirim!");
        // Setelah 2 detik, pindah ke halaman terimakasih.html
        setTimeout(() => {
            window.location.href = "terimakasih.html?nama=" + encodeURIComponent(namaUser);
        }, 800);
    })
    .catch(e => console.error("Gagal mengirim:", e));
}
let dataGlobal = null;
async function goRekap() { 
    go('Rekap'); 
    
    let tahunDipilih = document.getElementById('fTahun').value.toString();
    let rAvgElement = document.getElementById('rAvg');
    let predikatElement = document.getElementById('predikat-teks');
    
    rAvgElement.innerText = "Memuat...";

    try {
        const respon = await fetch(urlScript); 
        const hasil = await respon.json();

        dataGlobal = hasil; // ‚Üê WAJIB ADA

        renderRekap(); // ‚Üê panggil render setelah data ada

    } catch (e) {
        rAvgElement.innerText = "Error";
        console.error("Gagal koneksi:", e);
    }
}

   function renderRekap() {
    if (!dataGlobal) return;

    let tahunDipilih = document.getElementById('fTahun').value.toString();
    let rAvgElement = document.getElementById('rAvg');
    let predikatElement = document.getElementById('predikat-teks');
    let nilaiFinal = 0;

    // üî• Versi Fleksibel
    let histori = dataGlobal.dataHistori.find(item =>
        String(item.tahun) === tahunDipilih
    );

    if (histori) {
        nilaiFinal = histori.skor;
    } else {
        nilaiFinal = dataGlobal.skorLive;
    }

    let nilaiFixed = parseFloat(nilaiFinal).toFixed(2);
    rAvgElement.innerText = nilaiFixed + "%";

    let pred = "BAIK";
    if (nilaiFixed >= 88.31) pred = "SANGAT BAIK";
    else if (nilaiFixed < 76.61) pred = "KURANG BAIK";

    predikatElement.innerText = pred;
}


    function hapus(id) {
        if(confirm("Hapus data responden ini?")) {
            let db = JSON.parse(localStorage.getItem('dbArpusResmi')) || [];
            localStorage.setItem('dbArpusResmi', JSON.stringify(db.filter(i => i.id !== id)));
            renderRekap();
        }
    }
</script>
<script>
        // ... kode JavaScript lainnya (seperti fungsi go, prosesSimpan, dll) ...

        // GANTI BAGIAN INI:
        var swiper = new Swiper(".mySwiper", {
            slidesPerView: 3,       // Menampilkan 3 kartu di laptop
            spaceBetween: 30,      // Memberi jarak antar kartu
            loop: true,
            autoplay: {
                delay: 3000,       // Biar bisa geser otomatis
                disableOnInteraction: false,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            breakpoints: {
                // Di bawah 768px (HP) muncul 1 kartu
                0: {
                    slidesPerView: 1,
                    spaceBetween: 10
                },
                // Di atas 768px (Tablet) muncul 2 kartu
                768: {
                    slidesPerView: 2,
                    spaceBetween: 20
                },
                // Di atas 1024px (Laptop) muncul 3 kartu
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 30
                }
            }
        });
    </script>
</body>
</html>
</script>
</body>
</html> 
